double* reduce(double* p, double** L, double delta, long nSamples);